{
  "bltee7bc1be9d2d7177": {
    "stackHeaders": { "api_key": "bltee41ac4678a1dae3" },
    "urlPath": "/extensions/bltee7bc1be9d2d7177",
    "created_at": "2021-12-02T13:52:23.024Z",
    "updated_at": "2021-12-08T16:41:20.092Z",
    "created_by": "bltb1c4c58b3e6123d0",
    "updated_by": "blt9dd82d756a7a846c",
    "tags": [],
    "ACL": [],
    "_version": 4,
    "title": "BigCommerce",
    "config": {
      "url": "https://bvxf95bfa0.execute-api.us-east-2.amazonaws.com/default/BigCommerceInt",
      "type": "product_multiple",
      "page_count": "10",
      "store_id": "e8zpeno7n5",
      "redirect_url": "https://assets.contentstack.io/v3/assets/bltee41ac4678a1dae3/blt5b0b180612500206/61a8cf5d41ee302cc583609e/redirect.html"
    },
    "type": "field",
    "data_type": "json",
    "multiple": false,
    "srcdoc": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Bigcommerce Extensions GOGOGO</title>\n\n  <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\">\n  <script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script>\n  <script src=\"https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js\"></script>\n  <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\"></script>\n  <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\">\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.0/axios.min.js\"></script>\n  <script src=\"https://unpkg.com/@contentstack/ui-extensions-sdk@2.2.0/dist/ui-extension-sdk.js\"></script>\n  <link href=\"https://unpkg.com/@contentstack/ui-extensions-sdk@2.2.0/dist/ui-extension-sdk.css\" rel=\"stylesheet\">\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.12.1/polyfill.min.js\"></script>\n  <script src=\"https://unpkg.com/currency.js/dist/currency.min.js\"></script>\n  <style>.dropdown-toggle::after,.main{display:none}#loader{display:block}dl,ol,ul{margin-bottom:0}.selected-search{margin-left:6px;margin-top:6px}.error-text-product::before,.error-text::before{content:'';background:url(https://new-static.contentstack.io/images/error-icon.svg);background-size:cover;position:absolute;width:20px;height:20px;margin-left:-20px;margin-top:-5px}.error-text-product{color:red;-webkit-line-clamp:3!important;white-space:normal!important;text-align:center;font-size:12px!important;border:.1px solid gray;border-radius:3px;padding:20px;max-width:300px;margin:50px auto;background:#fff}.error-bg{background:#f0f8ff}.error-text{color:red;-webkit-line-clamp:3!important;white-space:normal!important;text-align:center}.li-search{width:100%;cursor:pointer;padding:6px 10px;margin:0;font-size:13px}.categories-field .selected-category li{padding-right:20px;line-height:normal}.dropdown-menu ul li:hover{background-color:#f5f5f5}.cs-table-body li div{list-style-position:inside;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;height:71px}#message-container{color:#f77d7a;display:none}.action span img{height:11px;width:11px}.cs-table-body .table-row .table-cell img{margin-top:-17px}.cs-table .cs-table-body .table-cell{color:#748590;padding:25px 15px;max-height:71px}.cs-table .cs-table-head{height:58px}.cs-table .cs-table-head .table-cell{padding:22px 10px 19px 15px}.action .remove:hover{cursor:pointer}.img-container{width:30%;height:200px;justify-content:center;display:flex;flex-direction:row;overflow:hidden;max-width:30%}.img-container .img-to-fit{width:100%;height:100%;object-fit:contain}.card-title,.text-muted{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical}.card-title{-webkit-line-clamp:2;font-size:17px;font-weight:700;margin-bottom:12px}.card-subtitle{font-size:15px;margin-bottom:5px}.col-sm-6{padding-right:.5rem;padding-left:.5rem}.categories-field{margin-bottom:10px}.row{margin-right:0;margin-left:0;margin-top:4px}.card:hover{box-shadow:0 0 11px rgba(33,33,33,.2)}.action{display:none;margin-top:-15px;margin-right:-10px;float:right}.card:hover .action{display:inline}.selected-item{max-height:400px;overflow:scroll;overflow-x:hidden}.selected-item::-webkit-scrollbar{width:5px;background-color:transparent}.selected-item::-webkit-scrollbar-thumb{border-radius:6px;background-color:#dfe2e9;cursor:pointer}.selected-item::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.categories-field .selected-category{max-height:382px;overflow-y:auto;margin-left:-19px;padding-left:19px;overflow-x:hidden}.categories-field .selected-category .category.selected{height:60px;overflow:hidden}.categories-field .selected-category .category{border-image:initial;border-radius:2px;background-color:#f8fffe;margin-left:0!important;border:1px solid #e6eced;box-shadow:0 1px 1px 0 rgba(0,0,0,.03);height:60px;overflow:hidden}.categories-field .selected-category .category .entry-ref-box{width:calc(100% - 71px);display:inline-block}.categories-field .selected-category .category.selected .entry-ref-box{padding:0 0 0 13px;position:relative;top:50%;transform:translateY(-50%)}.categories-field .selected-category .category .entry-ref-box .category-name{position:relative;padding-top:13px;padding-left:12px;padding-right:10px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.categories-field .selected-category .category.selected .entry-ref-box .category-name{position:static;padding-top:0;padding-left:0}.categories-field .selected-category .category.selected .entry-ref-box .refer-ct-name{font-size:12px;color:#a5abbb;margin-top:6px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.categories-field .selected-category .selected-category-action{float:right;position:relative;height:40px}.categories-field .selected-category .category.selected .selected-category-action{height:60px}.categories-field .selected-category .category.selected .entry-ref-box .refer-ct-name span{color:#748690}.categories-field .selected-category .action{padding:11px 10px 10px 13px;cursor:pointer;position:relative;height:38px;display:inline-block;width:45px;right:0;background-color:#f7f9fa}.categories-field .selected-category .category .action{width:50%;text-align:center;background:0 0}.categories-field .selected-category .category .action~.action{margin-left:-4px}.categories-field .selected-category .category.selected .selected-category-action .action{height:58px;padding-top:20px;margin:0}.categories-field .selected-category .edit-entry{border-left:1px solid #e6ecee;border-right:1px solid #e6ecee}.mb-3{height:210px}.btn{margin:10px 0 0 6px}@media (min-width:768px){.col-md-8{-ms-flex:0 0 70%;flex:0 0 70%;max-width:70%}}.col-md-8{width:70%;max-width:70%}</style>\n</head>\n\n<body>\n  <div id=\"loader\" class=\"reference-loading\">\n    <div class=\"loading-flash\">\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n  </div>\n  <div id=\"message-container\" class=\"invalid\"></div>\n  <div class=\"main\">\n    <div class=\"selected-item\">\n      <div class=\"row selected-list\">\n      </div>\n    </div>\n    <button class=\"btn cs-btn-success choose_product\">Choose ProductsSSS</button>\n  </div>\n  <script>class BigCommerce{constructor({url:t,type:e,page_count:r,store_id:i,redirect_url:a}){this.url=t,this.type=e,this.pageCount=r||10,this.storeId=i,this.redirectUrl=a,this.queryType=\"category\"!==this.type?\"product\":\"category\"}async request(t=1){let e={url:`${this.url}?query=${this.queryType}&page=${t}&limit=${this.pageCount}`,method:\"GET\"},r=await axios(e);return filterFetchedArray(r.data.data),r.data}async search(t,e=1){let r=activeSearchFilter.attr(\"id\"),i=r?`${r}=${t}`:`keyword=${t}`,a={url:`${this.url}?query=${this.queryType}&limit=${this.pageCount}&page=${e}&searchParam=${i}`,method:\"GET\"},u=await axios(a);return filterFetchedArray(u.data.data),u.data}async returnOption(t){return axios({url:`${this.url}?query=${this.queryType}&id=${t}`,method:\"GET\"})}async getSelectedProduct(t){let e=[];t.forEach(({id:t})=>e.push(this.returnOption(t)));try{return await axios.all(e)}catch(t){return t}}}function returnProductDetails(t){let e=t.id||\"\",r=t&&t.name||\"\",i=t&&t.description?t.description.replace(/(<([^>]+)>)/gi,\"\"):\"\",{sku:a,primary_image:u}=t||\"\";return{id:e,name:r,description:i,image:u&&u.url_thumbnail,price:`${currency(t.price)||\"Not Available\"}`,sku:a}}function returnCategoryDetail(t){let{id:e}=t||\"\";return{id:e,name:t&&t.name||\"\",customUrl:t&&t.custom_url&&t.custom_url.url||\"\",description:t&&t.description||\"Not Available\"}}</script>\n  <script>function saveExtensionData(){let e=[];selectedItems.forEach(t=>e.push({id:t.id})),extensionField.field.setData(e)}</script>\n  <script>let childWindow,extensionField,bigCommerce,selectedItems=[];const row=$(\".selected-list\");function popupwindow({url:e,title:t,w:n,h:s}){var i=screen.width/2-n/2,c=screen.height/2-s/2;return window.open(e,t,`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${n}, height=${s}, top=${c}, left=${i}`)}function appendCategory(e){let{id:t,customUrl:n,name:s}=returnCategoryDetail(e),{error:i}=e,c=`<div class=\"categories-field w-60\" id=${t}>\\n      <ul class=\"selected-category\">\\n        <li class=\"id\">\\n          <div class=\"category selected\">\\n            <div class=\"entry-ref-box\">\\n              <div class=\"category-name ${!i||\"error-text\"}\">${s?\"Category: <span>\"+s:i}</span></div>\\n              <div class=\"refer-ct-name\">${n?\"Custom url: <span>\"+n:\"\"}</span></div>\\n            </div>\\n            <div class=\"selected-category-action\">\\n              <span class=\"action\" onclick=\"remove('${t}')\">\\n                <img src=\"https://app.contentstack.com/static/images/remove-entry.svg\">\\n              </span>\\n              <span class=\"action edit-entry\">\\n                <a target=\"_blank\" href=\"https://store-${bigCommerce.storeId}.mybigcommerce.com/manage/products/categories/${t}/edit\">\\n                <img src=\"https://app.contentstack.com/static/images/edit-icon-ref1.svg\"></a>\\n              </span>\\n            </div>\\n          </div>\\n        </li>\\n      </ul>\\n      </div>`;selectedItems.push(e),row.append(c)}function appendProduct(e){let{id:t,name:n,description:s,image:i,price:c}=returnProductDetails(e),{error:o}=e,a=`<div class=\"col-sm-6\" id=${t}>\\n      <div class=\"card mb-3 ${!o||\"error-bg\"}\">\\n        <div class=\"row no-gutters\">\\n        ${i?`<div class=\"col-md-4 img-container\">\\n            <img class=\" img-to-fit\" src='${i}' alt=\"${n}\">\\n       </div>`:\"\"}\\n          <div class=\"col-md-8\">\\n            <div class=\"card-body\">\\n              <div class=\"action\">\\n                <span class=\"edit\">\\n                  <a target=\"_blank\" href=\"https://store-${bigCommerce.storeId}.mybigcommerce.com/manage/products/edit/${t}\"><img src=\"https://app.contentstack.com/static/images/edit-icon-ref1.svg\"></a>\\n                </span>\\n                <span class=\"remove\" onclick=\"remove('${t}')\">\\n                  <img src=\"https://app.contentstack.com/static/images/remove-entry.svg\">\\n                </span>\\n              </div>\\n              <h5 class=\"card-title ${!o||\"error-text-product\"}\" title=\"${n}\">${n||o}</h5>\\n              <h6 class=\"card-subtitle\">${o?\"\":`Price: ${c}`}</h6>\\n              <p class=\"card-text\" title=\"${s}\"><small class=\"text-muted\">${s}</small></p>\\n            </div>\\n          </div>\\n        </div>\\n      </div>\\n    </div>`;selectedItems.push(e),row.append(a),o&&$(`#${t} .col-md-8`).css({\"max-width\":\"100%\",flex:\"0 0 100%\"})}async function renderSelected(){let e=extensionField.field.getData()||[];if($(\".choose_product\").text(`Add ${\"category\"===bigCommerce.type?\"Category\":\"Products\"}`),null!=e&&!$.isEmptyObject(e)&&e.length>0){let t=await bigCommerce.getSelectedProduct(e);t&&t.forEach(({data:e})=>{\"category\"===bigCommerce.type?appendCategory(e.data):appendProduct(e.data)})}$(\"#loader\").hide(),$(\".main\").show()}async function renderSelectedfrmPopup(e){row.empty(),selectedItems=[],\"category\"===bigCommerce.type?e.forEach(e=>appendCategory(e)):e.forEach(e=>appendProduct(e)),saveExtensionData()}function handleMessage(e){\"openedReady\"===e.data?childWindow.postMessage({message:\"init\",config:extensionField.config,selectedItems:selectedItems},\"*\"):\"add\"===e.data.message?renderSelectedfrmPopup(e.data.selectedItems):\"close\"===e.data.message&&(childWindow=void 0)}function remove(e){selectedItems.splice(selectedItems.findIndex(t=>t.id===e),1),$(`#${e}`).remove(),saveExtensionData(),childWindow&&childWindow.postMessage({message:\"remove\",deletedId:e},\"*\")}$(\".choose_product\").click(()=>{childWindow?childWindow.focus():(childWindow=popupwindow({url:`${bigCommerce.redirectUrl||\"redirect.html\"}`,title:\"Big Commerce\",w:1600,h:800}),window.addEventListener(\"message\",handleMessage,!1))}),window.addEventListener(\"beforeunload\",e=>{childWindow&&childWindow.close(),childWindow=void 0}),$(document).ready(()=>{ContentstackUIExtension.init().then(async e=>{extensionField=e,Object.assign(e.config,e.fieldConfig),bigCommerce=new BigCommerce(e.config),renderSelected(),extensionField.window.enableAutoResizing(),extensionField.window.updateHeight()})});</script>\n</body>\n</html>"
  }
}
